<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View MCPE Addon</title>
</head>
<body>
    <h1>View Addon</h1>
    <div id="addonInfo">
        <h2 id="title"></h2>
        <p><strong>Creator:</strong> <span id="creator"></span></p>
        <p><strong>Description:</strong> <span id="description"></span></p>
        <img id="image" alt="Addon Image" style="max-width: 100%; height: auto;"><br><br>
        <a id="downloadLink" download>Download Addon</a>
    </div>

    <script>
        // Hàm để giải mã Base64
        function decodeBase64(str) {
            return decodeURIComponent(atob(str).split('').map(function(c) {
                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
            }).join(''));
        }

        // Lấy dữ liệu từ URL
        const urlParams = new URLSearchParams(window.location.search);
        const addonBase64 = urlParams.get('Addon');

        if (addonBase64) {
            const addonJson = decodeBase64(addonBase64);
            const addonData = JSON.parse(addonJson);

            // Hiển thị dữ liệu lên trang
            document.getElementById('title').innerText = addonData.title;
            document.getElementById('creator').innerText = addonData.creator;
            document.getElementById('description').innerText = addonData.description;

            // Hiển thị hình ảnh
            const imageSrc = `data:image/png;base64,${addonData.image}`;
            document.getElementById('image').src = imageSrc;

            // Tạo liên kết tải file Addon
            const addonBlob = new Blob([addonData.addonFile], { type: 'application/octet-stream' });
            const addonUrl = URL.createObjectURL(addonBlob);
            document.getElementById('downloadLink').href = addonUrl;
            document.getElementById('downloadLink').innerText = 'Download Addon';
        } else {
            document.getElementById('addonInfo').innerText = 'No Addon data found.';
        }
    </script>
</body>
</html>